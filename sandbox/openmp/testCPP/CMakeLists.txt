CMAKE_MINIMUM_REQUIRED(VERSION 3.1)
PROJECT(OpenMP_CXX CXX)

# -- C++11
SET(CMAKE_CXX_STANDARD 11) # newer way to set C++11 (requires cmake>=3.1)
SET(CMAKE_CXX_STANDARD_REQUIRED ON)

# OpenMP --
FIND_PACKAGE(OpenMP REQUIRED)
IF(OPENMP_FOUND)
    MESSAGE ("OpenMP_CXX_FLAGS=${OpenMP_CXX_FLAGS}")
    SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} ${OpenMP_C_FLAGS}")
    SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${OpenMP_CXX_FLAGS}")
ENDIF()

# TBB --
FIND_PATH(TBB_INCLUDE_DIRS NAMES  tbb/tbb.h HINTS "$ENV{TBBROOT}/include")
MESSAGE("TBB_INCLUDE_DIRS=${TBB_INCLUDE_DIRS}")
INCLUDE_DIRECTORIES(${TBB_INCLUDE_DIRS})

FIND_LIBRARY(TBB_LIBRARIES tbb ENV LD_LIBRARY_PATH)  # search paths in LD_LIBRARY_PATH
MESSAGE("TBB_LIBRARIES=${TBB_LIBRARIES}")

FILE(GLOB SRCS *.h *.cpp *.inl *.hpp)
ADD_EXECUTABLE(omp ${SRCS})
TARGET_LINK_LIBRARIES(omp ${TBB_LIBRARIES})

